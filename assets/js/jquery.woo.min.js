window.WooMinecraft=function(e,n,o){var r={};return r.l10n=woominecraft||{},r.cache=function(){r.$body=o("body"),r.$nonce=r.$body.find("#woo_minecraft_nonce"),r.$resend_donations=r.$body.find("#resendDonations")},r.init=function(){r.cache(),r.$body.on("click",".woo_minecraft_reset",r.resetForm),r.$body.on("click",".wmc_add_server",r.addRow),r.$body.on("click",".wmc_delete_server",r.removeRow),r.l10n.player_id?r.$resend_donations.on("click",r.resend_donations):r.$resend_donations.prop("disabled",!0)},r.curParent=function(e){var n=o(e),r=n.closest("table.woominecraft, div.wrap.woocommerce tr.woominecraft");return!!r.length&&r},r.addRow=function(n){n.preventDefault();var o=r.curParent(this);if(e.console.trace(o),!o)return!1;var t=o.find("tbody tr:first");if(e.console.trace(t),!t)return!1;var i=t.clone();i.find(":text").val(""),t.parent("tbody").append(i),r.reindexRows(o)},r.removeRow=function(n){n.preventDefault();var t=r.curParent(this);if(!t)return e.console.trace(t),!1;var i=t.find("tbody tr").length;return 0==i-1?(alert(r.l10n.must_have_single),!1):void o(this).closest("tr.row").fadeOut(200,function(){o(this).remove(),r.reindexRows(t)})},r.reindexRows=function(e){var n=e.find("tbody tr");return!!n&&void n.each(function(e){o(this).find(":text").each(function(){var n=o(this).attr("name");n=n.replace(/\[([0-9]+)\]/,"["+e+"]"),o(this).attr("name",n)}),o(this).find("select").each(function(){var n=o(this).attr("name");n=n.replace(/\[([0-9]+)\]/,"["+e+"]"),o(this).attr("name",n)})})},r.resend_donations=function(e){e.preventDefault();var n=o("select.wmc-server-select");return!(!n||""==n.val())&&(r.$resend_donations.prop("disabled",!0),void o.ajax({url:ajaxurl,data:{action:"wmc_resend_donations",order_id:r.l10n.order_id,player_id:r.l10n.player_id,server:n.val()},dataType:"json",method:"POST"}).done(r.xhrDone))},r.xhrDone=function(e,n,o){e.success&&alert(r.l10n.donations_resent),r.$resend_donations.prop("disabled",!1)},r.resetForm=function(e){e.preventDefault();var n=confirm(r.l10n.confirm);n&&o(this).closest(".form-fields").find("span").not(".woo_minecraft_copyme, .woocommerce-help-tip").fadeOut(200,function(){o(this).remove(),o("#variable_product_options .woocommerce_variations :input").trigger("change")})},r.log=function(){r.l10n.script_debug&&e.console&&e.console.log(Array.prototype.slice.call(arguments))},o(n).ready(r.init),r}(window,document,jQuery);